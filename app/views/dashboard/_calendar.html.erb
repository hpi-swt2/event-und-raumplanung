
<!---  use
            render 'calendar'
       inside ruby tags to display the calendar on any page
-->

<% @calevents = Event.events_between(Time.local(2015, 1, 1, 0, 0, 0), Time.local(2016, 1, 1, 0, 0, 0)) %>
<% @favorites = Favorite.all %>

<div id="calendar"></div>

<script>
	$(document).ready(function(){
		$("#calendar").fullCalendar({
			header: {
				left: 'prev,next today',
				center: 'title',
				right: 'month,agendaWeek,agendaDay'
			},
			events: [
                <% @calevents.each do |each| %>
					
					<% if each.event.user_id === current_user.id %>
					{
						title: '<%= each.event.name %>',
						start: '<%= each.starts_occurring_at %>'

                    	<% if each.event.is_approved %>
                        	, color: 'green'
                    	<% else %>
                    		, color: 'red'
                    	<% end %> 
					
					},
					<% end %>
                <% end %>

                <% @favorites.each do |each| %>
					
					<% @event = Event.find(each.event_id) %>
						<% if @event.user_id != current_user.id && each.is_favorite %>
						{
							title: '<%= @event.name %>',
							start: '<%= @event.starts_at %>'
							
							<% if @event.is_approved %>
		                       	, color: 'blue'
		                    <% else %>
		                    	, color: 'red'
		                    <% end %> 	
						},
						<% end %>
                <% end %>
			],
			theme: false
		});
	});
</script>